{# Required variables: fields, values, errors, attachments #}

{% for field in fields %}
{% set value = values[field['identifier']] %}
<fieldset class="form-group">
<div class="row">
  <label for="{{ field['identifier'] }}"
         class="col-md-2 col-form-label text-right font-weight-bold">
    {{ field['title'] }}
  </label>
  <div class="col-md">

    {% if field['type'] == constants.TEXT %}
    <textarea id="{{ field['identifier'] }}" name="{{ field['identifier'] }}"
	      class="form-control" rows="6"
	      {% if field.get('maxlength') %}
	      maxlength="{{ field['maxlength'] }}"
	      {% endif %}
	      aria-describedby="{{ field['identifier'] }}Help"
	      >{{ value or '' }}</textarea>

    {% elif field['type'] == constants.LINE %}
    <input type="text"
	   id="{{ field['identifier'] }}" name="{{ field['identifier'] }}"
	   class="form-control"
	   {% if field.get('maxlength') %}
	   maxlength="{{ field['maxlength'] }}"
	   {% endif %}
	   aria-describedby="{{ field['identifier'] }}Help"
	   value="{{ value or '' }}">

    {% elif field['type'] == constants.BOOLEAN %}
    <div class="form-check form-check-inline">
      <input type="radio"
             id="{{ field['identifier'] }}_yes" name="{{ field['identifier'] }}"
             class="form-check-input"
             {{ value == True and 'checked' }}
             value="true">
      <label class="form-check-label" for="{{ field['identifier'] }}_yes">
        Yes</label>
    </div>
    <div class="form-check form-check-inline">
      <input type="radio"
             id="{{ field['identifier'] }}_no" name="{{ field['identifier'] }}"
             class="form-check-input" 
             {{ value == False and 'checked' }}
             value="false">
      <label class="form-check-label" for="{{ field['identifier'] }}_no">
        No</label>
    </div>
    <div class="form-check form-check-inline">
      <input type="radio"
             id="{{ field['identifier'] }}_no" name="{{ field['identifier'] }}"
             class="form-check-input" 
             {{ utils.is_none(value) and 'checked' }}
             value="">
      <label class="form-check-label" for="{{ field['identifier'] }}_no">
        N/A</label>
    </div>
    {% elif field['type'] == constants.INTEGER %}
    <input type="number" step="1"
           {% if field.get('minimum') %}
           min="{{ field['minimum'] }}"
           {% endif %}
           {% if field.get('maximum') %}
           max="{{ field['maximum'] }}"
           {% endif %}
	   id="{{ field['identifier'] }}" name="{{ field['identifier'] }}"
	   class="form-control"
	   {% if field.get('maxlength') %}
	   maxlength="{{ field['maxlength'] }}"
	   {% endif %}
           {% if not utils.is_none(value) %}
	   value="{{ value }}"
           {% endif %}
	   aria-describedby="{{ field['identifier'] }}Help">

    {% elif field['type'] == constants.FLOAT %}
    <input type="number" step="0.01"
           {% if field.get('minimum') %}
           min="{{ field['minimum'] }}"
           {% endif %}
           {% if field.get('maximum') %}
           max="{{ field['maximum'] }}"
           {% endif %}
	   id="{{ field['identifier'] }}" name="{{ field['identifier'] }}"
	   class="form-control"
	   {% if field.get('maxlength') %}
	   maxlength="{{ field['maxlength'] }}"
	   {% endif %}
           {% if not utils.is_none(value) %}
	   value="{{ value }}"
           {% endif %}
	   aria-describedby="{{ field['identifier'] }}Help">

    {% elif field['type'] == constants.DOCUMENT %}
    <div class="custom-file">
      <input type="file"
	     id="{{ field['identifier'] }}" name="{{ field['identifier'] }}"
	     class="custom-file-input"
	     aria-describedby="{{ field['identifier'] }}Help">
      <label class="custom-file-label" for="{{ field['identifier'] }}">
        {{ value or 'Choose document' }}
      </label>
    </div>
    {% endif %}

    <small id="{{ field['identifier'] }}Help" class="form-text text-muted">
      <div class="row">
        {% if errors.get(field['identifier']) %}
	<div class="col-md-2 text-danger">
          Error: {{ errors[field['identifier']] }}
        </div>
        {% endif %}
	<div class="col-md">
	  {% if field.get('required') %}
	  <strong>Required!</strong>
	  {% endif %}
	  {% if field.get('maxlength') %}
	  Maximum {{ field['maxlength'] }} characters.
	  {% endif %}
	  {{ field.get('description') | markdown }}
	</div>
	{% if field['type'] == constants.TEXT %}
	<div class="col-md-3">
	  Formatted using <a href="{{ config['MARKDOWN_URL'] }}">Markdown</a>.
	</div>
	{% endif %}
      </div>
    </small>
  </div>
</div>
</fieldset>
{% endfor %} {# for field in fields #}
