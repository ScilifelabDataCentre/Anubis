{# Macros #}

{% macro user_link(user, fullname=True, chair=False) -%}
<a href="{{ url_for('user.display', username=user['username']) }}"
   class="font-weight-bold">
  {% if fullname and user.get('familyname') %}
  {{ user.get('givenname')|default('', True) }} {{ user['familyname'] }}
  {% else %}
  {{ user['username'] }}
  {% endif %}
  {% if chair %}
  (chair)
  {% endif %}
</a>
{%- endmacro %}

{% macro call_link(call) -%}
<a href="{{ url_for('call.display', cid=call['identifier']) }}"
   class="font-weight-bold">
  {{ call['identifier'] }}: {{ call['title'] or '' }}
</a>
{%- endmacro %}

{% macro proposal_link(proposal) -%}
<a href="{{ url_for('proposal.display', pid=proposal['identifier']) }}"
   title="{{ proposal['title'] or 'No title' }}"
   class="font-weight-bold">
  {{ proposal['identifier'] }} {{ proposal['title'] or 'No title' }}
</a>
{%- endmacro %}

{% macro review_link(review) -%}
<a href="{{ url_for('review.display', iuid=review['_id']) }}"
   class="font-weight-bold text-info">
  Review
</a>
{% if not review.get('finalized') %}
  <span class="badge badge-warning">Not finalized</span>
{% endif %}
{%- endmacro %}

{% macro call_closes(call) -%}
<span class="badge badge-{{ call['tmp']['color'] }}">
  {{ call['tmp']['text'] }}</span>
{%- endmacro %}

{% macro submitted(proposal, long=True) -%}
{% if proposal.get('submitted') %}
  <span class="badge badge-success">Submitted</span>
{% else %}
  <span class="badge badge-warning">Not submitted</span>
{% endif %}
{%- endmacro %}

{% macro decision_link(decision, block=False) -%}
{% if decision %}
  {% if decision.get('finalized') %}
    <a href="{{ url_for('decision.display', iuid=decision['_id']) }}"
       role="button"
       class="btn my-1 btn-dark font-weight-bold {{ block and 'btn-block' }}">
      Decision
    </a>
  {% else %}
    <a href="{{ url_for('decision.display', iuid=decision['_id']) }}"
       role="button"
       class="btn my-1 btn-outline-secondary {{ block and 'btn-block' }}">
      Decision
    </a>
  {% endif %}
{% else %}
  -
{% endif %} {# if decision #}
{%- endmacro %}
